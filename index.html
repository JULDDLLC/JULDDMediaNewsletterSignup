<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JULDD Media - Join The AI-Powered Kids' Newsletter</title>
    <style>
        /* --- A+ THEME & LAYOUT OVERHAUL --- */
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(-45deg, #1A202C, #2D3748, #1A202C, #1A202C);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
            min-height: 100vh; 
            padding: 20px; 
            color: #E2E8F0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container { 
            width: 100%;
            max-width: 700px; 
            background: #2D3748; 
            border-radius: 20px; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); 
            overflow: hidden; 
            border: 1px solid #4A5568;
        }
        
        .content-wrapper { display: grid; grid-template-columns: 1fr; gap: 0; }
        .image-section { line-height: 0; }
        .image-section img { width: 100%; height: auto; display: block; }
        .form-section { padding: 40px; }

        .form-header { margin-bottom: 25px; text-align: center; }
        .form-header h1 { color: #FFFFFF; font-size: 32px; margin-bottom: 10px; font-weight: 700; }
        .form-header p { color: #A0AEC0; font-size: 16px; line-height: 1.6; max-width: 500px; margin: 0 auto; }

        /* --- NEW: VALUE PROP SECTION --- */
        .value-prop-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
            text-align: center;
        }
        .value-prop-item { background: #1A202C; padding: 20px; border-radius: 10px; border: 1px solid #4A5568; }
        .value-prop-item svg { width: 40px; height: 40px; color: #38B2AC; margin-bottom: 10px; }
        .value-prop-item h3 { color: #FFFFFF; font-size: 14px; font-weight: 600; }

        /* --- NEW: MULTI-STEP FORM STYLES --- */
        #signupForm { position: relative; }
        .form-step { display: none; }
        .form-step.active-step { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            counter-reset: step;
        }
        .progress-step {
            width: 30px;
            height: 30px;
            background: #4A5568;
            color: #A0AEC0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }
        .progress-step.active { background: #38B2AC; color: #1A202C; }
        .progress-bar::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            width: 100%;
            height: 4px;
            background: #4A5568;
            z-index: 0;
        }
        .progress {
            position: absolute;
            top: 15px;
            left: 0;
            width: 0%;
            height: 4px;
            background: #38B2AC;
            z-index: 0;
            transition: width 0.4s ease;
        }

        .form-navigation { display: flex; justify-content: space-between; margin-top: 30px; }
        .nav-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .prev-btn { background: none; border: 2px solid #4A5568; color: #A0AEC0; }
        .prev-btn:hover { background: #4A5568; color: #FFFFFF; }
        .next-btn { background: #38B2AC; color: #1A202C; }
        .next-btn:hover { background: #4FD1C5; transform: translateY(-2px); }

        /* --- NEW: TESTIMONIAL SECTION --- */
        .testimonial {
            margin-top: 40px;
            padding: 20px;
            background: #1A202C;
            border-radius: 10px;
            border-left: 4px solid #38B2AC;
            font-style: italic;
            color: #A0AEC0;
        }
        .testimonial p { margin-bottom: 10px; }
        .testimonial-author { font-style: normal; font-weight: 700; color: #FFFFFF; text-align: right; }

        /* --- Standard Form Element Styling (Themed) --- */
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #CBD5E0; font-weight: 600; font-size: 14px; }
        input[type="text"], input[type="email"] { width: 100%; padding: 12px 15px; background-color: #1A202C; border: 2px solid #4A5568; color: #FFFFFF; border-radius: 8px; font-size: 14px; }
        input[type="text"]:focus, input[type="email"]:focus { outline: none; border-color: #38B2AC; box-shadow: 0 0 0 3px rgba(56, 178, 172, 0.3); }
        .children-section, .terms-section { background: #1A202C; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #4A5568; }
        .children-section h3, .terms-section h4 { color: #FFFFFF; }
        .terms-section { max-height: 200px; overflow-y: auto; }
        .terms-content { font-size: 12px; line-height: 1.6; color: #A0AEC0; }
        .terms-content h5 { color: #A0AEC0; font-size: 12px; margin-top: 12px; margin-bottom: 6px; font-weight: 600; }
        .terms-content p, .terms-content ul { margin-bottom: 10px; }
        .terms-content ul { margin-left: 20px; }
        .add-child-btn { background: #38B2AC; color: #1A202C; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 700; }
        .remove-child-btn { background: #E53E3E; color: white; border: none; padding: 10px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; }
        .checkbox-group { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 20px; }
        .checkbox-group input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; cursor: pointer; accent-color: #38B2AC; }
        .checkbox-group label { margin: 0; font-weight: 400; font-size: 13px; line-height: 1.5; cursor: pointer; color: #CBD5E0; }
        .submit-btn { width: 100%; padding: 14px; background: #38B2AC; color: #1A202C; border: none; border-radius: 8px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; }
        .submit-btn:hover { background: #4FD1C5; transform: translateY(-2px); box-shadow: 0 10px 25px rgba(56, 178, 172, 0.2); }
        .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; box-shadow: none; background: #4A5568; }
        .success-message { display: none; background: #48BB78; color: white; padding: 15px; border-radius: 8px; text-align: center; font-weight: 600; }
        .error-message { display: none; background: #E53E3E; color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; font-weight: 600; }
        .required { color: #38B2AC; }
        .loading { display: none; text-align: center; color: #FFFFFF; font-weight: 600; }
        .spinner { border: 3px solid #4A5568; border-top: 3px solid #38B2AC; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; vertical-align: middle; margin-right: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="container">
        <div class="content-wrapper">
            <div class="image-section">
                <img src="https://ldfacwgnawbpvufohzgm.supabase.co/storage/v1/object/public/image-uploads/loaded_images/join_the_waitlist_20251102_044756_29d9781f.png?" alt="JULDD Media Kids AI Newsletter">
            </div>
            <div class="form-section">
                <div class="form-header">
                    <h1>Unlock Your Child's AI Superpower</h1>
                    <p>Join our AI-powered kids' newsletter and get your first month completely free. Fun, engaging, and educational content delivered to your inbox.</p>
                </div>

                <div class="value-prop-section">
                    <div class="value-prop-item">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z" /></svg>
                        <h3>Engaging Animations</h3>
                    </div>
                    <div class="value-prop-item">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 013-3h.008c1.657 0 3 1.343 3 3v.008a3 3 0 01-3 3h-.008z" /></svg>
                        <h3>Audio Stories</h3>
                    </div>
                    <div class="value-prop-item">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 002.25-2.25V8.25a2.25 2.25 0 00-2.25-2.25H6.75A2.25 2.25 0 004.5 8.25v7.5a2.25 2.25 0 002.25 2.25z" /></svg>
                        <h3>AI-Powered Learning</h3>
                    </div>
                </div>

                <form id="signupForm" novalidate>
                    <div class="progress-bar">
                        <div class="progress"></div>
                        <div class="progress-step active" data-title="Parent">1</div>
                        <div class="progress-step" data-title="Kids">2</div>
                        <div class="progress-step" data-title="Finish">3</div>
                    </div>

                    <div class="success-message" id="successMessage" style="margin-top: 20px;">âœ“ Thank you! Check your email for a confirmation. Let's celebrate! ðŸŽ‰</div>
                    <div class="error-message" id="errorMessage"></div>

                    <!-- Step 1: Parent Info -->
                    <div class="form-step active-step">
                        <div class="form-group">
                            <label for="parentName">Parent/Guardian Name <span class="required">*</span></label>
                            <input type="text" id="parentName" name="parentName" required placeholder="Enter your full name">
                        </div>
                        <div class="form-group">
                            <label for="parentEmail">Email Address <span class="required">*</span></label>
                            <input type="email" id="parentEmail" name="parentEmail" required placeholder="your@email.com">
                        </div>
                    </div>

                    <!-- Step 2: Children Info -->
                    <div class="form-step">
                        <div class="children-section">
                            <h3>Who in your household is joining? <span class="required">*</span><button type="button" class="add-child-btn" onclick="addChildField()">+ Add Child</button></h3>
                            <div id="childrenContainer">
                                <div class="child-input-group">
                                    <input type="text" class="childName" placeholder="Child's name" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Terms & Submit -->
                    <div class="form-step">
                        <div class="terms-section">
                            <h4>ðŸ“‹ The Important Stuff</h4>
                            <div class="terms-content">
                                <h5>1. Free Trial & Subscription</h5><p>You get one (1) month of complimentary access. After that, standard rates apply. We'll notify you before any charges.</p>
                                <h5>2. Cancellation Policy</h5><p>You can cancel anytime, no questions asked.</p>
                                <h5>4. Data Privacy & COPPA Compliance</h5><ul><li>We are fully COPPA compliant.</li><li>We only collect necessary info: parent name, email, and children's names.</li><li>Your data will never be sold. Period.</li></ul>
                            </div>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="agreeTerms" name="agreeTerms" required>
                            <label for="agreeTerms">I agree to the Terms & Conditions.</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="agreePrivacy" name="agreePrivacy" required>
                            <label for="agreePrivacy">I consent to receive newsletter updates and agree to the privacy policy.</label>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="form-navigation">
                        <button type="button" class="nav-btn prev-btn">Back</button>
                        <button type="button" class="nav-btn next-btn">Next</button>
                        <button type="submit" class="submit-btn" id="submitBtn" style="display: none;">Get 1 Month Free</button>
                    </div>
                </form>

                <div class="testimonial">
                    <p>"My 8-year-old is obsessed! She's learning about AI and doesn't even realize it's 'schoolwork'. We can't wait for the next issue."</p>
                    <p class="testimonial-author">- Sarah P., Mom of 2</p>
                </div>

            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <script>
        // --- A+ JAVASCRIPT FOR MULTI-STEP FORM ---
        const prevBtn = document.querySelector('.prev-btn');
        const nextBtn = document.querySelector('.next-btn');
        const submitBtn = document.getElementById('submitBtn');
        const formSteps = document.querySelectorAll('.form-step');
        const progressSteps = document.querySelectorAll('.progress-step');
        const progress = document.querySelector('.progress');
        const signupForm = document.getElementById('signupForm');
        
        let currentStep = 0;

        function updateFormSteps() {
            formSteps.forEach((step, index) => {
                step.classList.toggle('active-step', index === currentStep);
            });

            progressSteps.forEach((step, index) => {
                step.classList.toggle('active', index <= currentStep);
            });
            
            const progressPercentage = (currentStep / (formSteps.length - 1)) * 100;
            progress.style.width = `${progressPercentage}%`;

            prevBtn.style.display = currentStep > 0 ? 'block' : 'none';
            nextBtn.style.display = currentStep < formSteps.length - 1 ? 'block' : 'none';
            submitBtn.style.display = currentStep === formSteps.length - 1 ? 'block' : 'none';
        }

        function validateStep() {
            const currentFields = formSteps[currentStep].querySelectorAll('[required]');
            let isValid = true;
            for (const field of currentFields) {
                if ((field.type === 'checkbox' && !field.checked) || (field.type !== 'checkbox' && field.value.trim() === '')) {
                    isValid = false;
                    break;
                }
            }
            if (!isValid) {
                showError('Please fill out all required fields.');
                return false;
            }
            // Specific email validation for step 0
            if (currentStep === 0) {
                const emailField = document.getElementById('parentEmail');
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(emailField.value)) {
                    showError('Please enter a valid email address.');
                    return false;
                }
            }
            // Specific child name validation for step 1
            if (currentStep === 1) {
                const childrenNames = Array.from(document.querySelectorAll('.childName')).map(el => el.value.trim()).filter(name => name !== '');
                if (childrenNames.length === 0) {
                    showError('Please add at least one child\'s name.');
                    return false;
                }
            }
            errorMessage.style.display = 'none';
            return true;
        }

        nextBtn.addEventListener('click', () => {
            if (validateStep()) {
                currentStep++;
                updateFormSteps();
            }
        });

        prevBtn.addEventListener('click', () => {
            currentStep--;
            updateFormSteps();
        });

        // Initialize form
        updateFormSteps();

        // --- Existing Form Submission & Helper Logic (Slightly Modified) ---
        const loading = document.createElement('div');
        loading.className = 'loading';
        loading.innerHTML = `<span class="spinner"></span>Processing...`;
        
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        const childrenContainer = document.getElementById('childrenContainer');

        function addChildField() {
            const newField = document.createElement('div');
            newField.className = 'child-input-group';
            newField.innerHTML = `<input type="text" class="childName" placeholder="Child's name" required><button type="button" class="remove-child-btn" onclick="removeChildField(this)">Remove</button>`;
            childrenContainer.appendChild(newField);
        }

        function removeChildField(button) {
            if (childrenContainer.children.length > 1) {
                button.parentElement.remove();
            } else {
                showError('At least one child name is required.');
            }
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            successMessage.style.display = 'none';
        }

        function launchConfetti() {
            const duration = 3 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 9999 };
            function randomInRange(min, max) { return Math.random() * (max - min) + min; }
            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                const particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        signupForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            if (!validateStep()) return;

            // Hide form, show loading message
            formSteps.forEach(step => step.style.display = 'none');
            document.querySelector('.form-navigation').style.display = 'none';
            document.querySelector('.progress-bar').style.display = 'none';
            signupForm.prepend(loading);
            loading.style.display = 'block';
            
            try {
                const parentName = document.getElementById('parentName').value.trim();
                const parentEmail = document.getElementById('parentEmail').value.trim();
                const childrenNames = Array.from(document.querySelectorAll('.childName')).map(el => el.value.trim()).filter(name => name !== '').join(', ');
                
                const formData = { parentName, parentEmail, childrenNames };
                const response = await fetch('/api/signup', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) });
                const result = await response.json();
                if (!response.ok) { throw new Error(result.message || 'Submission failed. Please try again.'); }

                // Success! Hide loading, show success message
                loading.style.display = 'none';
                successMessage.style.display = 'block';
                launchConfetti();
                
                // Hide testimonial after success to focus on the message
                const testimonial = document.querySelector('.testimonial');
                if (testimonial) testimonial.style.display = 'none';

            } catch (error) {
                showError(error.message);
                // On error, bring back the form to the last step
                loading.style.display = 'none';
                formSteps.forEach(step => step.style.display = 'none');
                formSteps[currentStep].style.display = 'block';
                document.querySelector('.form-navigation').style.display = 'flex';
                document.querySelector('.progress-bar').style.display = 'flex';
            }
        });
    </script>
</body>
</html>
